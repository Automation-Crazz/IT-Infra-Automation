import requests
import pandas as pd

# NVD API URL for Linux-related CVEs (max 2000 results)
url = "https://services.nvd.nist.gov/rest/json/cves/2.0?keywordSearch=Linux&resultsPerPage=2000"

# Fetch data
response = requests.get(url).json()
vulnerabilities = response.get('vulnerabilities', [])

# Parse into a list of dictionaries
cve_list = []
for vuln in vulnerabilities:
    cve = vuln['cve']
    cve_list.append({
        'CVE': cve['id'],
        'Published': cve['published'],
        'Vendor': cve.get('sourceIdentifier', 'N/A'),
        'Product': 'Linux',  # Default, customize as needed
        'CVSS': cve['metrics']['cvssMetricV3'][0]['cvssData']['baseScore'] if 'cvssMetricV3' in cve['metrics'] else 'N/A',
        'Description': cve['descriptions'][0]['value']
    })

# Convert to DataFrame and save as CSV
df = pd.DataFrame(cve_list)
df.to_csv('linux_cves.csv', index=False)
print(f"Saved {len(df)} CVEs to 'linux_cves.csv'")